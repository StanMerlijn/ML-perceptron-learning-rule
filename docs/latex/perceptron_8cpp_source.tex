\doxysection{perceptron.\+cpp}
\hypertarget{perceptron_8cpp_source}{}\label{perceptron_8cpp_source}\index{/Users/stanislav/Github/MachineLearning/ML-\/perceptron-\/learning-\/rule/src/perceptron.cpp@{/Users/stanislav/Github/MachineLearning/ML-\/perceptron-\/learning-\/rule/src/perceptron.cpp}}
\mbox{\hyperlink{perceptron_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00011}00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{perceptron_8hpp}{header/perceptron.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00013}\mbox{\hyperlink{class_perceptron_a5291f385a6169ebc70a003a4dccd226f}{00013}}\ \mbox{\hyperlink{class_perceptron_a5291f385a6169ebc70a003a4dccd226f}{Perceptron::Perceptron}}(std::vector<double>\ weights,\ \textcolor{keywordtype}{double}\ bias,\ \textcolor{keywordtype}{double}\ learningRate)}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00014}00014\ \ \ \ \ :\ weights(weights),\ bias(bias),\ learningRate(learningRate)\ \{\}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00016}\mbox{\hyperlink{class_perceptron_a3f2ed0bfcf45a37c23e25f544fd9f2ce}{00016}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_perceptron_a3f2ed0bfcf45a37c23e25f544fd9f2ce}{Perceptron::predict}}(\textcolor{keyword}{const}\ std::vector<float>\&\ inputs)\textcolor{keyword}{\ const\ }}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00017}00017\ \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00018}00018\ \ \ \ \ \textcolor{comment}{//\ Dot\ prodcut\ for\ an\ array\ of\ size\ 2\ \ }}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00019}00019\ \ \ \ \ \textcolor{keywordtype}{double}\ dot\_product\ =\ bias;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00020}00020\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ weights.size();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00021}00021\ \ \ \ \ \ \ \ \ dot\_product\ +=\ weights[i]\ *\ inputs[i];}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00022}00022\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00023}00023\ \ \ \ \ \textcolor{comment}{//\ Threshold\ function}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{return}\ dot\_product\ >=\ 0\ ?\ 1\ :\ 0;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00025}00025\ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00027}\mbox{\hyperlink{class_perceptron_a500dc3aaba030166b4b57a72922a8378}{00027}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_perceptron_a500dc3aaba030166b4b57a72922a8378}{Perceptron::update}}(\textcolor{keyword}{const}\ std::vector<std::vector<float>>\&\ inputs,\ \textcolor{keyword}{const}\ std::vector<int>\&\ targets,\ \textcolor{keywordtype}{int}\ epochs)\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00028}00028\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00029}00029\ \ \ \ \ \textcolor{comment}{//\ ensure\ both\ arrays\ are\ the\ same\ size}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00030}00030\ \ \ \ \ \textcolor{keywordflow}{if}\ (inputs.size()\ !=\ targets.size())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00032}00032\ \ \ \ \ \textcolor{comment}{//\ Train\ the\ perceptron}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ epoch\ =\ 0;\ epoch\ <\ epochs;\ epoch++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Loop\ through\ each\ input}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inputs.size();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ prediction\ and\ error}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ pred\ =\ \mbox{\hyperlink{class_perceptron_a3f2ed0bfcf45a37c23e25f544fd9f2ce}{predict}}(inputs[i]);}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ error\ =\ targets[i]\ -\/\ pred;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ each\ weight\ based\ on\ the\ input\ value}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ weights.size();\ j++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ weights[j]\ +=\ learningRate\ *\ error\ *\ inputs[i][j];}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ bias\ }}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ bias\ +=\ learningRate\ *\ error;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00047}00047\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00048}00048\ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00050}\mbox{\hyperlink{class_perceptron_ac489510834318a52fa05291f0a38f34c}{00050}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_perceptron_ac489510834318a52fa05291f0a38f34c}{Perceptron::loss}}(\textcolor{keyword}{const}\ std::vector<std::vector<float>>\&\ inputs,\ \textcolor{keyword}{const}\ std::vector<int>\&\ targets)\textcolor{keyword}{\ const}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00051}00051\ \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00052}00052\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ predictions\ for\ the\ inputs}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00053}00053\ \ \ \ \ std::vector<int>\ predictions;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ inputs.size();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00055}00055\ \ \ \ \ \ \ \ \ predictions.push\_back(\mbox{\hyperlink{class_perceptron_a3f2ed0bfcf45a37c23e25f544fd9f2ce}{predict}}(inputs[i]));}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00056}00056\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00057}00057\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_m_s_e_8hpp_a0e4e2ce9121d7f51ccc0d354270b1647}{MSE}}(targets,\ predictions);}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00058}00058\ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00060}\mbox{\hyperlink{class_perceptron_aded865cff86e00ce42a97125bb66b5ae}{00060}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_perceptron_aded865cff86e00ce42a97125bb66b5ae}{Perceptron::\_\_str\_\_}}(\textcolor{keywordtype}{int}\ verbose)\textcolor{keyword}{\ const}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00061}00061\ \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00062}00062\ \ \ \ \ \textcolor{comment}{//\ Printing\ the\ weights\ }}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00063}00063\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}weights\ for\ the\ perceptron:\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ weights.size();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00065}00065\ \ \ \ \ \ \ \ \ std::cout\ <<\ weights[i]\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00066}00066\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00067}00067\ \ \ \ \ \textcolor{comment}{//\ Other\ info\ }}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{if}\ (verbose\ >=\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00069}00069\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nbias\ =\ "{}}\ <<\ bias\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00070}00070\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Learning\ rate\ =\ "{}}\ <<\ learningRate\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00071}00071\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{perceptron_8cpp_source_l00072}00072\ \}}

\end{DoxyCode}
